[Unit]
Description=Volition Ear (Social Router & Digest Generator)
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/volition

# Environment
Environment=REDIS_HOST=
Environment=REDIS_PORT=6379
Environment=REDIS_PASSWORD=volition
Environment=SUMMARIZE_BACKEND=claude
Environment=CLAUDE_CLI=claude
Environment=CLAUDE_MODEL_SUMMARIZE=claude-sonnet-4-6

# Ollama fallback (local summarization if preferred, set SUMMARIZE_BACKEND=ollama)
Environment=OLLAMA_URL=http://localhost:11434/api
Environment=MODEL_SUMMARIZE=mistral


# Python (same venv as gpu-worker)
ExecStart=/opt/volition/venv/bin/python /opt/volition/ear.py

# Restart behavior
Restart=always
RestartSec=3

# Logging
StandardOutput=journal
StandardError=journal

# This is a listener, keep it polite
Nice=5
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
